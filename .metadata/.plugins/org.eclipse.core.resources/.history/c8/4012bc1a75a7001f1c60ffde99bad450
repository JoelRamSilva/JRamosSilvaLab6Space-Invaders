/*
 * Game_Menu.c
 *
 *  Created on: Nov 20, 2024
 *      Author: joelrsilva
 */

#include "Game_Menu.h"

// Menu Button Dimensions
#define START_BUTTON_X 90
#define START_BUTTON_Y 200
#define START_BUTTON_WIDTH 140
#define START_BUTTON_HEIGHT 50

// Initialize the Menu
void menu_init(void) {
	menu_render(void);
}

void menu_render(void) {
    // Clear screen
    BSP_LCD_Clear(LCD_COLOR_BLACK);

    // Draw Title
    BSP_LCD_SetTextColor(LCD_COLOR_WHITE);
    BSP_LCD_DisplayStringAt(0, 50, (uint8_t *)"SPACE INVADERS", CENTER_MODE);

    // Draw Start Button
    BSP_LCD_SetTextColor(LCD_COLOR_GREEN);
    BSP_LCD_FillRect(START_BUTTON_X, START_BUTTON_Y, START_BUTTON_WIDTH, START_BUTTON_HEIGHT);

    BSP_LCD_SetTextColor(LCD_COLOR_BLACK);
    BSP_LCD_DisplayStringAt(0, START_BUTTON_Y + 15, (uint8_t *)"START", CENTER_MODE);

    // Instruction Text
    BSP_LCD_SetTextColor(LCD_COLOR_RED);
    BSP_LCD_DisplayStringAt(0, 300, (uint8_t *)"Touch START to play!", CENTER_MODE);
}

// Handle Touch Events
void menu_handle_touch(void) {
    TS_StateTypeDef TS_State;
    BSP_TS_GetState(&TS_State);

    if (TS_State.TouchDetected) {
        uint16_t x = TS_State.X;
        uint16_t y = TS_State.Y;

        // Check if "Start" button was touched
        if (x > START_BUTTON_X && x < (START_BUTTON_X + START_BUTTON_WIDTH) &&
            y > START_BUTTON_Y && y < (START_BUTTON_Y + START_BUTTON_HEIGHT)) {
            // "Start" button pressed
            BSP_LCD_Clear(LCD_COLOR_BLACK);
            BSP_LCD_DisplayStringAt(0, 120, (uint8_t *)"Starting Game...", CENTER_MODE);
            HAL_Delay(1000);  // Simulate loading delay

            // Call game start function (to be implemented)
            extern void startGame(void);
            startGame();
        }
    }
}

